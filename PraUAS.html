
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Klasifikasi Prediksi kekambuhan Kanker Tiroid (PRA UAS) &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'PraUAS';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Klasifikasi UAS" href="pendatUAS.html" />
    <link rel="prev" title="Data Binning" href="Data%20Binning.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pendat-tugas2.html"><strong>Pembukaan Data Mining</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="PendatTugas3.html"><strong>Deteksi Outlier dengan Metode K-Nearest Neighbors (KNN)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="PendatTugas4LOF.html">Local Outlier Factor (LOF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Klasifikasi.html"><strong>Klasifikasi pada Iris dataset</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="230411100167_PendatUTS.html">Pendat UTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tugas6Clustering.html">Clustering Iris dataset dengan K- Mean</a></li>
<li class="toctree-l1"><a class="reference internal" href="C-Means%20Clustering.html">Fuzzy C-Mean Clustering</a></li>

<li class="toctree-l1"><a class="reference internal" href="decisiontree.html">Decision Tree Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data%20Binning.html">Data Binning</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Klasifikasi Prediksi kekambuhan Kanker Tiroid (PRA UAS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="pendatUAS.html">Klasifikasi UAS</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FPraUAS.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/PraUAS.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Klasifikasi Prediksi kekambuhan Kanker Tiroid (PRA UAS)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#informasi-dataset">Informasi Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">Modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-bayes-ensemble-gabungan-gaussiannb-categorikalnb">Naive Bayes Ensemble(gabungan) GaussianNB+CategorikalNB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-dengan-metode-decision-tree">Klasifikasi dengan metode Decision Tree</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="klasifikasi-prediksi-kekambuhan-kanker-tiroid-pra-uas">
<h1>Klasifikasi Prediksi kekambuhan Kanker Tiroid (PRA UAS)<a class="headerlink" href="#klasifikasi-prediksi-kekambuhan-kanker-tiroid-pra-uas" title="Link to this heading">#</a></h1>
<p>##Data Understading</p>
<section id="informasi-dataset">
<h2>Informasi Dataset<a class="headerlink" href="#informasi-dataset" title="Link to this heading">#</a></h2>
<p>Dataset ini berisi 17 fitur klinikopatologis yang bertujuan untuk memprediksi kekambuhan kanker tiroid yang terdefinisi dengan baik. Dataset ini dikumpulkan selama 15 tahun dan setiap pasien diikuti selama setidaknya 10 tahun.</p>
<p>Di dataset ini tidak ada missing value</p>
<p>Sumber : <a class="reference external" href="https://archive.ics.uci.edu/dataset/915/differentiated+thyroid+cancer+recurrence">https://archive.ics.uci.edu/dataset/915/differentiated+thyroid+cancer+recurrence</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">ucimlrepo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: ucimlrepo in /usr/local/lib/python3.11/dist-packages (0.0.7)
Requirement already satisfied: pandas&gt;=1.0.0 in /usr/local/lib/python3.11/dist-packages (from ucimlrepo) (2.2.2)
Requirement already satisfied: certifi&gt;=2020.12.5 in /usr/local/lib/python3.11/dist-packages (from ucimlrepo) (2025.6.15)
Requirement already satisfied: numpy&gt;=1.23.2 in /usr/local/lib/python3.11/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2.0.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2025.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=1.0.0-&gt;ucimlrepo) (1.17.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ucimlrepo</span><span class="w"> </span><span class="kn">import</span> <span class="n">fetch_ucirepo</span>

<span class="c1"># fetch dataset</span>
<span class="n">differentiated_thyroid_cancer_recurrence</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">915</span><span class="p">)</span>

<span class="c1"># data (as pandas dataframes)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">differentiated_thyroid_cancer_recurrence</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">differentiated_thyroid_cancer_recurrence</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span>

<span class="c1"># metadata</span>
<span class="nb">print</span><span class="p">(</span><span class="n">differentiated_thyroid_cancer_recurrence</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

<span class="c1"># variable information</span>
<span class="nb">print</span><span class="p">(</span><span class="n">differentiated_thyroid_cancer_recurrence</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;uci_id&#39;: 915, &#39;name&#39;: &#39;Differentiated Thyroid Cancer Recurrence&#39;, &#39;repository_url&#39;: &#39;https://archive.ics.uci.edu/dataset/915/differentiated+thyroid+cancer+recurrence&#39;, &#39;data_url&#39;: &#39;https://archive.ics.uci.edu/static/public/915/data.csv&#39;, &#39;abstract&#39;: &#39;This data set contains 13 clinicopathologic features aiming to predict recurrence of well differentiated thyroid cancer. The data set was collected in duration of 15 years and each patient was followed for at least 10 years.&#39;, &#39;area&#39;: &#39;Health and Medicine&#39;, &#39;tasks&#39;: [&#39;Classification&#39;], &#39;characteristics&#39;: [&#39;Tabular&#39;], &#39;num_instances&#39;: 383, &#39;num_features&#39;: 16, &#39;feature_types&#39;: [&#39;Real&#39;, &#39;Categorical&#39;, &#39;Integer&#39;], &#39;demographics&#39;: [&#39;Age&#39;, &#39;Gender&#39;], &#39;target_col&#39;: [&#39;Recurred&#39;], &#39;index_col&#39;: None, &#39;has_missing_values&#39;: &#39;no&#39;, &#39;missing_values_symbol&#39;: None, &#39;year_of_dataset_creation&#39;: 2023, &#39;last_updated&#39;: &#39;Wed Mar 20 2024&#39;, &#39;dataset_doi&#39;: &#39;10.24432/C5632J&#39;, &#39;creators&#39;: [&#39;Shiva Borzooei&#39;, &#39;Aidin Tarokhian&#39;], &#39;intro_paper&#39;: {&#39;ID&#39;: 333, &#39;type&#39;: &#39;NATIVE&#39;, &#39;title&#39;: &#39;Machine learning for risk stratification of thyroid cancer patients: a 15-year cohort study&#39;, &#39;authors&#39;: &#39;Shiva Borzooei, Giovanni Briganti, Mitra Golparian, Jerome R. Lechien, Aidin Tarokhian&#39;, &#39;venue&#39;: &#39;Head and Neck&#39;, &#39;year&#39;: 2023, &#39;journal&#39;: None, &#39;DOI&#39;: None, &#39;URL&#39;: &#39;https://link.springer.com/article/10.1007/s00405-023-08299-w&#39;, &#39;sha&#39;: None, &#39;corpus&#39;: None, &#39;arxiv&#39;: None, &#39;mag&#39;: None, &#39;acl&#39;: None, &#39;pmid&#39;: None, &#39;pmcid&#39;: None}, &#39;additional_info&#39;: {&#39;summary&#39;: None, &#39;purpose&#39;: &#39;It was a part of research in the field of AI and Medicine&#39;, &#39;funded_by&#39;: &#39;No funding was provided.&#39;, &#39;instances_represent&#39;: &#39;Individual patients&#39;, &#39;recommended_data_splits&#39;: &#39;No&#39;, &#39;sensitive_data&#39;: &#39;No&#39;, &#39;preprocessing_description&#39;: None, &#39;variable_info&#39;: None, &#39;citation&#39;: &#39;Please cite the original article if you use the data set for secondary research and public demonstrations:\nhttps://doi.org/10.1007/s00405-023-08299-w&#39;}}
                    name     role         type demographic description units  \
0                    Age  Feature      Integer         Age        None  None   
1                 Gender  Feature  Categorical      Gender        None  None   
2                Smoking  Feature  Categorical        None        None  None   
3             Hx Smoking  Feature  Categorical        None        None  None   
4        Hx Radiothreapy  Feature  Categorical        None        None  None   
5       Thyroid Function  Feature  Categorical        None        None  None   
6   Physical Examination  Feature  Categorical        None        None  None   
7             Adenopathy  Feature  Categorical        None        None  None   
8              Pathology  Feature  Categorical        None        None  None   
9               Focality  Feature  Categorical        None        None  None   
10                  Risk  Feature  Categorical        None        None  None   
11                     T  Feature  Categorical        None        None  None   
12                     N  Feature  Categorical        None        None  None   
13                     M  Feature  Categorical        None        None  None   
14                 Stage  Feature  Categorical        None        None  None   
15              Response  Feature  Categorical        None        None  None   
16              Recurred   Target  Categorical        None        None  None   

   missing_values  
0              no  
1              no  
2              no  
3              no  
4              no  
5              no  
6              no  
7              no  
8              no  
9              no  
10             no  
11             no  
12             no  
13             no  
14             no  
15             no  
16             no  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Age Gender Smoking Hx Smoking Hx Radiothreapy          Thyroid Function  \
0   27      F      No         No              No                 Euthyroid   
1   34      F      No        Yes              No                 Euthyroid   
2   30      F      No         No              No                 Euthyroid   
3   62      F      No         No              No                 Euthyroid   
4   62      F      No         No              No                 Euthyroid   
5   52      M     Yes         No              No                 Euthyroid   
6   41      F      No        Yes              No  Clinical Hyperthyroidism   
7   46      F      No         No              No                 Euthyroid   
8   51      F      No         No              No                 Euthyroid   
9   40      F      No         No              No                 Euthyroid   

          Physical Examination Adenopathy       Pathology     Focality Risk  \
0   Single nodular goiter-left         No  Micropapillary    Uni-Focal  Low   
1          Multinodular goiter         No  Micropapillary    Uni-Focal  Low   
2  Single nodular goiter-right         No  Micropapillary    Uni-Focal  Low   
3  Single nodular goiter-right         No  Micropapillary    Uni-Focal  Low   
4          Multinodular goiter         No  Micropapillary  Multi-Focal  Low   
5          Multinodular goiter         No  Micropapillary  Multi-Focal  Low   
6  Single nodular goiter-right         No  Micropapillary    Uni-Focal  Low   
7  Single nodular goiter-right         No  Micropapillary    Uni-Focal  Low   
8  Single nodular goiter-right         No  Micropapillary    Uni-Focal  Low   
9  Single nodular goiter-right         No  Micropapillary    Uni-Focal  Low   

     T   N   M Stage       Response  
0  T1a  N0  M0     I  Indeterminate  
1  T1a  N0  M0     I      Excellent  
2  T1a  N0  M0     I      Excellent  
3  T1a  N0  M0     I      Excellent  
4  T1a  N0  M0     I      Excellent  
5  T1a  N0  M0     I  Indeterminate  
6  T1a  N0  M0     I      Excellent  
7  T1a  N0  M0     I      Excellent  
8  T1a  N0  M0     I      Excellent  
9  T1a  N0  M0     I      Excellent  
  Recurred
0       No
1       No
2       No
3       No
4       No
5       No
6       No
7       No
8       No
9       No
Index([&#39;Age&#39;, &#39;Gender&#39;, &#39;Smoking&#39;, &#39;Hx Smoking&#39;, &#39;Hx Radiothreapy&#39;,
       &#39;Thyroid Function&#39;, &#39;Physical Examination&#39;, &#39;Adenopathy&#39;, &#39;Pathology&#39;,
       &#39;Focality&#39;, &#39;Risk&#39;, &#39;T&#39;, &#39;N&#39;, &#39;M&#39;, &#39;Stage&#39;, &#39;Response&#39;],
      dtype=&#39;object&#39;)
Index([&#39;Recurred&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrdinalEncoder</span>

<span class="c1"># Salin data untuk keamanan</span>
<span class="n">X_encoded</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Encode fitur Boolean dulu (seperti sebelumnya)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="n">binary_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Radiothreapy&#39;</span><span class="p">,</span> <span class="s1">&#39;Adenopathy&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">binary_features</span><span class="p">:</span>
    <span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="n">X_encoded</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

<span class="c1"># Encode semua fitur kategorikal menjadi angka dengan OrdinalEncoder</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Thyroid Function&#39;</span><span class="p">,</span> <span class="s1">&#39;Physical Examination&#39;</span><span class="p">,</span> <span class="s1">&#39;Pathology&#39;</span><span class="p">,</span> <span class="s1">&#39;Focality&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Risk&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Stage&#39;</span><span class="p">,</span> <span class="s1">&#39;Response&#39;</span><span class="p">]</span>
<span class="n">ordinal_encoder</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">()</span>
<span class="n">X_encoded</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">ordinal_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">])</span>

<span class="c1"># Lihat hasilnya</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_encoded</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Age  Gender  Smoking  Hx Smoking  Hx Radiothreapy  Thyroid Function  Physical Examination  Adenopathy  Pathology  Focality  Risk   T   N   M  Stage  Response
  27       0        0           0                0               2.0                   3.0           3        2.0       1.0   2.0 0.0 0.0 0.0    0.0       2.0
  34       0        0           1                0               2.0                   1.0           3        2.0       1.0   2.0 0.0 0.0 0.0    0.0       1.0
  30       0        0           0                0               2.0                   4.0           3        2.0       1.0   2.0 0.0 0.0 0.0    0.0       1.0
  62       0        0           0                0               2.0                   4.0           3        2.0       1.0   2.0 0.0 0.0 0.0    0.0       1.0
  62       0        0           0                0               2.0                   1.0           3        2.0       0.0   2.0 0.0 0.0 0.0    0.0       1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="c1"># 1. Split data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># 2. Buat model Naive Bayes dan latih</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># 3. Prediksi dan evaluasi</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Output evaluasi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Akurasi:&quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Akurasi: 0.8831168831168831

Confusion Matrix:
 [[57  1]
 [ 8 11]]

Classification Report:
               precision    recall  f1-score   support

          No       0.88      0.98      0.93        58
         Yes       0.92      0.58      0.71        19

    accuracy                           0.88        77
   macro avg       0.90      0.78      0.82        77
weighted avg       0.89      0.88      0.87        77
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.11/dist-packages/sklearn/utils/validation.py:1408: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Age  Gender  Smoking  Hx Smoking  Hx Radiothreapy  Thyroid Function  \
0     27       0        0           0                0               2.0   
1     34       0        0           1                0               2.0   
2     30       0        0           0                0               2.0   
3     62       0        0           0                0               2.0   
4     62       0        0           0                0               2.0   
..   ...     ...      ...         ...              ...               ...   
378   72       1        1           1                1               2.0   
379   81       1        1           0                1               2.0   
380   72       1        1           1                0               2.0   
381   61       1        1           1                1               0.0   
382   67       1        1           0                0               2.0   

     Physical Examination  Adenopathy  Pathology  Focality  Risk    T    N  \
0                     3.0           3        2.0       1.0   2.0  0.0  0.0   
1                     1.0           3        2.0       1.0   2.0  0.0  0.0   
2                     4.0           3        2.0       1.0   2.0  0.0  0.0   
3                     4.0           3        2.0       1.0   2.0  0.0  0.0   
4                     1.0           3        2.0       0.0   2.0  0.0  0.0   
..                    ...         ...        ...       ...   ...  ...  ...   
378                   4.0           5        3.0       1.0   0.0  6.0  2.0   
379                   1.0           1        3.0       0.0   0.0  6.0  2.0   
380                   1.0           0        3.0       0.0   0.0  6.0  2.0   
381                   1.0           1        1.0       0.0   0.0  6.0  2.0   
382                   1.0           0        3.0       0.0   0.0  6.0  2.0   

       M  Stage  Response  
0    0.0    0.0       2.0  
1    0.0    0.0       1.0  
2    0.0    0.0       1.0  
3    0.0    0.0       1.0  
4    0.0    0.0       1.0  
..   ...    ...       ...  
378  1.0    4.0       0.0  
379  1.0    4.0       3.0  
380  1.0    4.0       3.0  
381  0.0    3.0       3.0  
382  0.0    3.0       3.0  

[383 rows x 16 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelling">
<h2>Modelling<a class="headerlink" href="#modelling" title="Link to this heading">#</a></h2>
<section id="naive-bayes-ensemble-gabungan-gaussiannb-categorikalnb">
<h3>Naive Bayes Ensemble(gabungan) GaussianNB+CategorikalNB<a class="headerlink" href="#naive-bayes-ensemble-gabungan-gaussiannb-categorikalnb" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span><span class="p">,</span> <span class="n">CategoricalNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OrdinalEncoder</span><span class="p">,</span> <span class="n">LabelEncoder</span>

<span class="c1"># === 1. Pra-pemrosesan Fitur ===</span>

<span class="c1"># Fitur numerik dan kategorikal</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Radiothreapy&#39;</span><span class="p">,</span> <span class="s1">&#39;Thyroid Function&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Physical Examination&#39;</span><span class="p">,</span> <span class="s1">&#39;Adenopathy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pathology&#39;</span><span class="p">,</span> <span class="s1">&#39;Focality&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Risk&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Stage&#39;</span><span class="p">,</span> <span class="s1">&#39;Response&#39;</span><span class="p">]</span>

<span class="c1"># Salin data</span>
<span class="n">X_num</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_cat</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># NORMALISASI fitur numerik</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_num_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_num</span><span class="p">)</span>

<span class="c1"># Encoding fitur kategorikal</span>
<span class="n">ordinal_encoder</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">()</span>
<span class="n">X_cat_encoded</span> <span class="o">=</span> <span class="n">ordinal_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_cat</span><span class="p">)</span>

<span class="c1"># Gabungkan fitur numerik dan kategorikal</span>
<span class="n">X_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">X_num_scaled</span><span class="p">,</span> <span class="n">X_cat_encoded</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># === 2. Encoding Target y ===</span>

<span class="n">le_y</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">y_encoded</span> <span class="o">=</span> <span class="n">le_y</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># &quot;No&quot; -&gt; 0, &quot;Yes&quot; -&gt; 1</span>

<span class="c1"># === 3. Split Data ===</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_combined</span><span class="p">,</span> <span class="n">y_encoded</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Pisahkan kembali fitur numerik dan kategorikal untuk masing-masing model</span>
<span class="n">X_train_num</span><span class="p">,</span> <span class="n">X_train_cat</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
<span class="n">X_test_num</span><span class="p">,</span> <span class="n">X_test_cat</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>

<span class="c1"># === 4. Modeling ===</span>

<span class="c1"># Model Gaussian untuk numerik</span>
<span class="n">gnb</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">gnb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_num</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Model Categorical untuk kategorikal</span>
<span class="n">cnb</span> <span class="o">=</span> <span class="n">CategoricalNB</span><span class="p">()</span>
<span class="n">cnb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_cat</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Prediksi probabilitas dari masing-masing model</span>
<span class="n">proba_num</span> <span class="o">=</span> <span class="n">gnb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_num</span><span class="p">)</span>
<span class="n">proba_cat</span> <span class="o">=</span> <span class="n">cnb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_cat</span><span class="p">)</span>

<span class="c1"># Kombinasi rata-rata probabilitas</span>
<span class="n">combined_proba</span> <span class="o">=</span> <span class="p">(</span><span class="n">proba_num</span> <span class="o">+</span> <span class="n">proba_cat</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">combined_proba</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># === 5. Evaluasi ===</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Akurasi:&quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">le_y</span><span class="o">.</span><span class="n">classes_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Akurasi: 0.948051948051948

Confusion Matrix:
 [[57  1]
 [ 3 16]]

Classification Report:
               precision    recall  f1-score   support

          No       0.95      0.98      0.97        58
         Yes       0.94      0.84      0.89        19

    accuracy                           0.95        77
   macro avg       0.95      0.91      0.93        77
weighted avg       0.95      0.95      0.95        77
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.11/dist-packages/sklearn/preprocessing/_label.py:110: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</pre></div>
</div>
</div>
</div>
<p>Mencari Data Valid untuk data Kategorikal</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;Physical Examination&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gender
[&#39;F&#39; &#39;M&#39;]
 
Smoking
[&#39;No&#39; &#39;Yes&#39;]
 
Hx Smoking
[&#39;No&#39; &#39;Yes&#39;]
 
Hx Radiothreapy
[&#39;No&#39; &#39;Yes&#39;]
 
Thyroid Function
[&#39;Euthyroid&#39; &#39;Clinical Hyperthyroidism&#39; &#39;Clinical Hypothyroidism&#39;
 &#39;Subclinical Hyperthyroidism&#39; &#39;Subclinical Hypothyroidism&#39;]
 
Physical Examination
[&#39;Single nodular goiter-left&#39; &#39;Multinodular goiter&#39;
 &#39;Single nodular goiter-right&#39; &#39;Normal&#39; &#39;Diffuse goiter&#39;]
 
Adenopathy
[&#39;No&#39; &#39;Right&#39; &#39;Extensive&#39; &#39;Left&#39; &#39;Bilateral&#39; &#39;Posterior&#39;]
 
Pathology
[&#39;Micropapillary&#39; &#39;Papillary&#39; &#39;Follicular&#39; &#39;Hurthel cell&#39;]
 
Focality
[&#39;Uni-Focal&#39; &#39;Multi-Focal&#39;]
 
Risk
[&#39;Low&#39; &#39;Intermediate&#39; &#39;High&#39;]
 
T
[&#39;T1a&#39; &#39;T1b&#39; &#39;T2&#39; &#39;T3a&#39; &#39;T3b&#39; &#39;T4a&#39; &#39;T4b&#39;]
 
N
[&#39;N0&#39; &#39;N1b&#39; &#39;N1a&#39;]
 
M
[&#39;M0&#39; &#39;M1&#39;]
 
Stage
[&#39;I&#39; &#39;II&#39; &#39;IVB&#39; &#39;III&#39; &#39;IVA&#39;]
 
Response
[&#39;Indeterminate&#39; &#39;Excellent&#39; &#39;Structural Incomplete&#39;
 &#39;Biochemical Incomplete&#39;]
 
[&#39;Single nodular goiter-left&#39; &#39;Multinodular goiter&#39;
 &#39;Single nodular goiter-right&#39; &#39;Normal&#39; &#39;Diffuse goiter&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OrdinalEncoder</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span><span class="p">,</span> <span class="n">CategoricalNB</span>

<span class="c1"># PASTIKAN KOLOM DAN TIPE DATANYA SAMA PERSIS DENGAN DATA PELATIHAN ASLI!</span>
<span class="c1"># new_data = X.head(3)</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">72</span><span class="p">],</span>
    <span class="s1">&#39;Gender&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Smoking&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Hx Smoking&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Hx Radiothreapy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Thyroid Function&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Euthyroid&#39;</span><span class="p">,</span> <span class="s1">&#39;Euthyroid&#39;</span><span class="p">,</span> <span class="s1">&#39;Clinical Hyperthyroidism&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Physical Examination&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Single nodular goiter-left&#39;</span><span class="p">,</span> <span class="s1">&#39;Single nodular goiter-left&#39;</span><span class="p">,</span> <span class="s1">&#39;Single nodular goiter-left&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Adenopathy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Pathology&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Micropapillary&#39;</span><span class="p">,</span> <span class="s1">&#39;Micropapillary&#39;</span><span class="p">,</span> <span class="s1">&#39;Micropapillary&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Focality&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Uni-Focal&#39;</span><span class="p">,</span> <span class="s1">&#39;Multi-Focal&#39;</span><span class="p">,</span> <span class="s1">&#39;Uni-Focal&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Risk&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Intermediate&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">],</span>
    <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;T2&#39;</span><span class="p">,</span> <span class="s1">&#39;T4a&#39;</span><span class="p">,</span> <span class="s1">&#39;T1a&#39;</span><span class="p">],</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;N0&#39;</span><span class="p">,</span> <span class="s1">&#39;N1b&#39;</span><span class="p">,</span> <span class="s1">&#39;N0&#39;</span><span class="p">],</span>
    <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;M0&#39;</span><span class="p">,</span> <span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;M0&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Stage&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;IVB&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Response&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Excellent&#39;</span><span class="p">,</span> <span class="s1">&#39;Indeterminate&#39;</span><span class="p">,</span> <span class="s1">&#39;Excellent&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Data Baru untuk Prediksi ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

<span class="c1"># --- 2. Pra-pemrosesan Data Baru ---</span>

<span class="c1"># Pisahkan fitur numerik dan kategorikal dari data baru</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="c1"># Definisikan ulang agar mudah dibaca di sini</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Radiothreapy&#39;</span><span class="p">,</span> <span class="s1">&#39;Thyroid Function&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Physical Examination&#39;</span><span class="p">,</span> <span class="s1">&#39;Adenopathy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pathology&#39;</span><span class="p">,</span> <span class="s1">&#39;Focality&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Risk&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Stage&#39;</span><span class="p">,</span> <span class="s1">&#39;Response&#39;</span><span class="p">]</span> <span class="c1"># Definisikan ulang</span>

<span class="n">new_data_num</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">new_data_cat</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Standarisasi fitur numerik menggunakan **scaler yang sudah dilatih**</span>
<span class="n">new_data_num_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">new_data_num</span><span class="p">)</span>

<span class="c1"># Encoding fitur kategorikal menggunakan **ordinal_encoder yang sudah dilatih**</span>
<span class="c1"># Jika ada kategori di new_data_cat yang tidak pernah dilihat oleh ordinal_encoder saat fit,</span>
<span class="c1"># ini akan menimbulkan ValueError. Pastikan semua kategori di data baru sudah ada di data training.</span>
<span class="n">new_data_cat_encoded</span> <span class="o">=</span> <span class="n">ordinal_encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">new_data_cat</span><span class="p">)</span>

<span class="c1"># Gabungkan fitur numerik dan kategorikal</span>
<span class="n">new_data_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">new_data_num_scaled</span><span class="p">,</span> <span class="n">new_data_cat_encoded</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Pisahkan kembali untuk prediksi oleh masing-masing model</span>
<span class="c1"># Jumlah kolom numerik dan kategorikal harus sama dengan saat pelatihan</span>
<span class="n">num_cols_for_gaussian</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">numerical_features</span><span class="p">)</span> <span class="c1"># Harusnya 1 (untuk &#39;Age&#39;)</span>
<span class="n">num_cols_for_categorical</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorical_features</span><span class="p">)</span> <span class="c1"># Harusnya 16</span>

<span class="n">new_data_num_pred</span> <span class="o">=</span> <span class="n">new_data_combined</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num_cols_for_gaussian</span><span class="p">]</span>
<span class="n">new_data_cat_pred</span> <span class="o">=</span> <span class="n">new_data_combined</span><span class="p">[:,</span> <span class="n">num_cols_for_gaussian</span> <span class="p">:</span> <span class="n">num_cols_for_gaussian</span> <span class="o">+</span> <span class="n">num_cols_for_categorical</span><span class="p">]</span>

<span class="c1"># --- 3. Prediksi dengan Model Ensemble ---</span>

<span class="c1"># Prediksi probabilitas dari masing-masing model</span>
<span class="n">new_proba_num</span> <span class="o">=</span> <span class="n">gnb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">new_data_num_pred</span><span class="p">)</span>
<span class="n">new_proba_cat</span> <span class="o">=</span> <span class="n">cnb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">new_data_cat_pred</span><span class="p">)</span>

<span class="c1"># Kombinasi rata-rata probabilitas</span>
<span class="n">new_combined_proba</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_proba_num</span> <span class="o">+</span> <span class="n">new_proba_cat</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">new_y_pred_encoded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">new_combined_proba</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Mengubah kembali prediksi ke label asli (&quot;No&quot; atau &quot;Yes&quot;)</span>
<span class="n">new_y_pred_labels</span> <span class="o">=</span> <span class="n">le_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">new_y_pred_encoded</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Hasil Prediksi untuk Data Baru ---&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pred_label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_y_pred_labels</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pasien </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: Kekambuhan Kanker Tiroid Diprediksi: </span><span class="si">{</span><span class="n">pred_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Data Baru untuk Prediksi ---
   Age Gender Smoking Hx Smoking Hx Radiothreapy          Thyroid Function  \
0   58      F      No         No             Yes                 Euthyroid   
1   45      M     Yes         No              No                 Euthyroid   
2   72      F      No        Yes              No  Clinical Hyperthyroidism   

         Physical Examination Adenopathy       Pathology     Focality  \
0  Single nodular goiter-left         No  Micropapillary    Uni-Focal   
1  Single nodular goiter-left         No  Micropapillary  Multi-Focal   
2  Single nodular goiter-left         No  Micropapillary    Uni-Focal   

           Risk    T    N   M Stage       Response  
0  Intermediate   T2   N0  M0     I      Excellent  
1          High  T4a  N1b  M1   IVB  Indeterminate  
2           Low  T1a   N0  M0     I      Excellent  

--- Hasil Prediksi untuk Data Baru ---
Pasien 1: Kekambuhan Kanker Tiroid Diprediksi: No
Pasien 2: Kekambuhan Kanker Tiroid Diprediksi: Yes
Pasien 3: Kekambuhan Kanker Tiroid Diprediksi: No
</pre></div>
</div>
</div>
</div>
<p>###KNN Classification</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OrdinalEncoder</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># ASUMSI:</span>
<span class="c1"># - Variabel &#39;X&#39; (fitur dataset asli) dan &#39;y&#39; (target dataset asli) sudah ada.</span>

<span class="c1"># === 1. Pra-pemrosesan Fitur ===</span>

<span class="c1"># Definisikan fitur numerik dan kategorikal</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Radiothreapy&#39;</span><span class="p">,</span> <span class="s1">&#39;Thyroid Function&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Physical Examination&#39;</span><span class="p">,</span> <span class="s1">&#39;Adenopathy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pathology&#39;</span><span class="p">,</span> <span class="s1">&#39;Focality&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Risk&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Stage&#39;</span><span class="p">,</span> <span class="s1">&#39;Response&#39;</span><span class="p">]</span>

<span class="c1"># Salin data untuk pra-pemrosesan</span>
<span class="n">X_processed</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Standarisasi fitur numerik</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_processed</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_processed</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">])</span>

<span class="c1"># Encoding fitur kategorikal dengan OrdinalEncoder</span>
<span class="n">ordinal_encoder</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">()</span>
<span class="n">X_processed</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">ordinal_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_processed</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">])</span>

<span class="c1"># Gabungkan semua fitur yang sudah diproses menjadi satu array NumPy</span>
<span class="c1"># Pastikan urutan kolom sesuai dengan definisi features Anda</span>
<span class="n">X_combined</span> <span class="o">=</span> <span class="n">X_processed</span><span class="p">[</span><span class="n">numerical_features</span> <span class="o">+</span> <span class="n">categorical_features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>


<span class="c1"># === 2. Encoding Target y ===</span>
<span class="n">le_y</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">y_encoded</span> <span class="o">=</span> <span class="n">le_y</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># &quot;No&quot; -&gt; 0, &quot;Yes&quot; -&gt; 1</span>

<span class="c1"># === 3. Split Data ===</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_combined</span><span class="p">,</span> <span class="n">y_encoded</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># === 4. Modeling KNN ===</span>

<span class="c1"># Inisialisasi model KNN</span>
<span class="c1"># n_neighbors=5 adalah nilai K yang umum digunakan, bisa disesuaikan</span>
<span class="c1"># metrik &#39;euclidean&#39; adalah default dan cocok untuk data yang sudah discale</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Latih model KNN</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Prediksi pada data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># === 5. Evaluasi ===</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Hasil Evaluasi Model KNN dengan OrdinalEncoder ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Akurasi:&quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">le_y</span><span class="o">.</span><span class="n">classes_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Hasil Evaluasi Model KNN dengan OrdinalEncoder ---
Akurasi: 0.9090909090909091

Confusion Matrix:
 [[57  1]
 [ 6 13]]

Classification Report:
               precision    recall  f1-score   support

          No       0.90      0.98      0.94        58
         Yes       0.93      0.68      0.79        19

    accuracy                           0.91        77
   macro avg       0.92      0.83      0.87        77
weighted avg       0.91      0.91      0.90        77
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.11/dist-packages/sklearn/preprocessing/_label.py:110: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span> <span class="c1"># Penting untuk menggabungkan pra-pemrosesan</span>

<span class="c1"># ASUMSI:</span>
<span class="c1"># - Variabel &#39;X&#39; (fitur dataset asli) dan &#39;y&#39; (target dataset asli) sudah ada.</span>

<span class="c1"># === 1. Pra-pemrosesan Fitur dengan One-Hot Encoding ===</span>

<span class="c1"># Definisikan fitur-fitur Anda</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span>
<span class="c1"># Semua fitur kategorikal akan di-One-Hot Encode</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Radiothreapy&#39;</span><span class="p">,</span> <span class="s1">&#39;Thyroid Function&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Physical Examination&#39;</span><span class="p">,</span> <span class="s1">&#39;Adenopathy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pathology&#39;</span><span class="p">,</span> <span class="s1">&#39;Focality&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Risk&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Stage&#39;</span><span class="p">,</span> <span class="s1">&#39;Response&#39;</span><span class="p">]</span>

<span class="c1"># Buat ColumnTransformer untuk menggabungkan pra-pemrosesan</span>
<span class="c1"># &#39;remainder=&quot;passthrough&quot;&#39; akan mempertahankan kolom yang tidak disebutkan (misalnya, jika ada kolom lain yang tidak diolah)</span>
<span class="c1"># Tetapi di sini kita akan secara eksplisit memilih kolom.</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">numerical_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">),</span> <span class="n">categorical_features</span><span class="p">)</span> <span class="c1"># handle_unknown=&#39;ignore&#39; untuk data baru</span>
    <span class="p">])</span>

<span class="c1"># Terapkan pra-pemrosesan pada seluruh dataset X</span>
<span class="n">X_combined</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># === 2. Encoding Target y ===</span>
<span class="n">le_y</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">y_encoded</span> <span class="o">=</span> <span class="n">le_y</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># &quot;No&quot; -&gt; 0, &quot;Yes&quot; -&gt; 1</span>

<span class="c1"># === 3. Split Data ===</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_combined</span><span class="p">,</span> <span class="n">y_encoded</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># === 4. Modeling KNN ===</span>

<span class="c1"># Inisialisasi model KNN</span>
<span class="c1"># n_neighbors=5 adalah nilai K yang umum digunakan, bisa disesuaikan</span>
<span class="c1"># metrik &#39;euclidean&#39; adalah default dan cocok untuk data yang sudah discale dan one-hot encoded</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Latih model KNN</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Prediksi pada data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># === 5. Evaluasi ===</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Hasil Evaluasi Model KNN dengan One-Hot Encoder ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Akurasi:&quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">le_y</span><span class="o">.</span><span class="n">classes_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Hasil Evaluasi Model KNN dengan One-Hot Encoder ---
Akurasi: 0.922077922077922

Confusion Matrix:
 [[56  2]
 [ 4 15]]

Classification Report:
               precision    recall  f1-score   support

          No       0.93      0.97      0.95        58
         Yes       0.88      0.79      0.83        19

    accuracy                           0.92        77
   macro avg       0.91      0.88      0.89        77
weighted avg       0.92      0.92      0.92        77
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.11/dist-packages/sklearn/preprocessing/_label.py:110: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OrdinalEncoder</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span> <span class="c1"># Import model KNN</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># Asumsi:</span>
<span class="c1"># - Variabel &#39;X&#39; (fitur dataset asli) dan &#39;y&#39; (target dataset asli) sudah ada.</span>

<span class="c1"># --- 1. Pra-pemrosesan Fitur ---</span>

<span class="c1"># Definisikan fitur numerik dan kategorikal</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Radiothreapy&#39;</span><span class="p">,</span> <span class="s1">&#39;Thyroid Function&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Physical Examination&#39;</span><span class="p">,</span> <span class="s1">&#39;Adenopathy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pathology&#39;</span><span class="p">,</span> <span class="s1">&#39;Focality&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Risk&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Stage&#39;</span><span class="p">,</span> <span class="s1">&#39;Response&#39;</span><span class="p">]</span>

<span class="c1"># Salin data untuk pra-pemrosesan</span>
<span class="n">X_processed</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># **Standarisasi fitur numerik**</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_processed</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_processed</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">])</span>

<span class="c1"># **Encoding fitur kategorikal dengan OrdinalEncoder**</span>
<span class="c1"># OrdinalEncoder akan mengubah string menjadi angka integer non-negatif.</span>
<span class="c1"># Ini mengasumsikan ada urutan implisit antar kategori, yang mungkin tidak selalu benar.</span>
<span class="n">ordinal_encoder</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">()</span>
<span class="n">X_processed</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">ordinal_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_processed</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">])</span>

<span class="c1"># Gabungkan semua fitur yang sudah diproses menjadi satu array NumPy</span>
<span class="c1"># Pastikan urutan kolom sesuai dengan definisi fitur Anda</span>
<span class="n">X_combined</span> <span class="o">=</span> <span class="n">X_processed</span><span class="p">[</span><span class="n">numerical_features</span> <span class="o">+</span> <span class="n">categorical_features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>


<span class="c1"># --- 2. Encoding Target y ---</span>
<span class="c1"># Mengubah target &#39;Recurred&#39; menjadi angka (0 atau 1)</span>
<span class="n">le_y</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">y_encoded</span> <span class="o">=</span> <span class="n">le_y</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># &quot;No&quot; -&gt; 0, &quot;Yes&quot; -&gt; 1</span>

<span class="c1"># --- 3. Split Data ---</span>
<span class="c1"># Memisahkan data menjadi set pelatihan dan pengujian</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_combined</span><span class="p">,</span> <span class="n">y_encoded</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># --- 4. Modelling KNN ---</span>

<span class="c1"># Inisialisasi model KNeighborsClassifier</span>
<span class="c1"># n_neighbors: Jumlah tetangga terdekat yang akan dipertimbangkan. Nilai 5 adalah titik awal yang umum.</span>
<span class="c1"># metric: Metrik jarak yang digunakan. &#39;euclidean&#39; adalah default dan cocok untuk data yang sudah discale.</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>

<span class="c1"># Latih model KNN pada data pelatihan</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Prediksi pada data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># --- 5. Evaluasi ---</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Hasil Evaluasi Model KNN dengan OrdinalEncoder ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">le_y</span><span class="o">.</span><span class="n">classes_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.11/dist-packages/sklearn/preprocessing/_label.py:110: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Hasil Evaluasi Model KNN dengan OrdinalEncoder ---
Akurasi: 0.9091

Confusion Matrix:
 [[57  1]
 [ 6 13]]

Classification Report:
               precision    recall  f1-score   support

          No       0.90      0.98      0.94        58
         Yes       0.93      0.68      0.79        19

    accuracy                           0.91        77
   macro avg       0.92      0.83      0.87        77
weighted avg       0.91      0.91      0.90        77
</pre></div>
</div>
</div>
</div>
</section>
<section id="klasifikasi-dengan-metode-decision-tree">
<h3>Klasifikasi dengan metode Decision Tree<a class="headerlink" href="#klasifikasi-dengan-metode-decision-tree" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OrdinalEncoder</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecisionTreeClassifier</span> <span class="c1"># Import model Decision Tree</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># Asumsi:</span>
<span class="c1"># - Variabel &#39;X&#39; (fitur dataset asli) dan &#39;y&#39; (target dataset asli) sudah ada.</span>

<span class="c1"># === 1. Pra-pemrosesan Fitur ===</span>

<span class="c1"># Definisikan fitur numerik dan kategorikal</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Smoking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hx Radiothreapy&#39;</span><span class="p">,</span> <span class="s1">&#39;Thyroid Function&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Physical Examination&#39;</span><span class="p">,</span> <span class="s1">&#39;Adenopathy&#39;</span><span class="p">,</span> <span class="s1">&#39;Pathology&#39;</span><span class="p">,</span> <span class="s1">&#39;Focality&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Risk&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Stage&#39;</span><span class="p">,</span> <span class="s1">&#39;Response&#39;</span><span class="p">]</span>

<span class="c1"># Salin data untuk pra-pemrosesan agar tidak merusak data asli</span>
<span class="n">X_processed</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># **Standardisasi fitur numerik**</span>
<span class="c1"># Ini dilakukan untuk konsistensi, meskipun Decision Tree tidak terpengaruh oleh skala.</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_processed</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_processed</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">])</span>

<span class="c1"># **Encoding fitur kategorikal dengan OrdinalEncoder**</span>
<span class="c1"># Mengubah kategori string menjadi representasi numerik (integer non-negatif).</span>
<span class="n">ordinal_encoder</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">()</span>
<span class="n">X_processed</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">ordinal_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_processed</span><span class="p">[</span><span class="n">categorical_features</span><span class="p">])</span>

<span class="c1"># Gabungkan semua fitur yang sudah diproses menjadi satu array NumPy</span>
<span class="c1"># Pastikan urutan kolom sesuai dengan definisi fitur Anda</span>
<span class="n">X_combined</span> <span class="o">=</span> <span class="n">X_processed</span><span class="p">[</span><span class="n">numerical_features</span> <span class="o">+</span> <span class="n">categorical_features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>


<span class="c1"># === 2. Encoding Target y ===</span>
<span class="c1"># Mengubah target &#39;Recurred&#39; menjadi angka (0 atau 1)</span>
<span class="n">le_y</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">y_encoded</span> <span class="o">=</span> <span class="n">le_y</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># &quot;No&quot; -&gt; 0, &quot;Yes&quot; -&gt; 1</span>

<span class="c1"># === 3. Split Data ===</span>
<span class="c1"># Memisahkan data menjadi set pelatihan dan pengujian</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_combined</span><span class="p">,</span> <span class="n">y_encoded</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># === 4. Modelling Decision Tree ===</span>

<span class="c1"># Inisialisasi model DecisionTreeClassifier</span>
<span class="c1"># random_state=42 untuk memastikan hasil yang sama setiap kali dijalankan.</span>
<span class="n">dt_classifier</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Latih model Decision Tree pada data pelatihan</span>
<span class="n">dt_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Prediksi pada data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">dt_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># --- 5. Evaluasi ---</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Hasil Evaluasi Model Decision Tree dengan Ordinal Encoding ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">le_y</span><span class="o">.</span><span class="n">classes_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Hasil Evaluasi Model Decision Tree dengan Ordinal Encoding ---
Akurasi: 0.9221

Confusion Matrix:
 [[54  4]
 [ 2 17]]

Classification Report:
               precision    recall  f1-score   support

          No       0.96      0.93      0.95        58
         Yes       0.81      0.89      0.85        19

    accuracy                           0.92        77
   macro avg       0.89      0.91      0.90        77
weighted avg       0.93      0.92      0.92        77
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.11/dist-packages/sklearn/preprocessing/_label.py:110: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Data%20Binning.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Binning</p>
      </div>
    </a>
    <a class="right-next"
       href="pendatUAS.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Klasifikasi UAS</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#informasi-dataset">Informasi Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">Modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-bayes-ensemble-gabungan-gaussiannb-categorikalnb">Naive Bayes Ensemble(gabungan) GaussianNB+CategorikalNB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-dengan-metode-decision-tree">Klasifikasi dengan metode Decision Tree</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vio
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>